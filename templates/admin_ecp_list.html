{% extends "base.html" %}
{% block content %}
{% if not requests_list %}
    <p class="hint">Записей на ЭЦП пока нет.</p>
{% else %}
    <ul class="card-list">
        {% for r in requests_list %}
            {% set id, created_at,
                     full_name, role, ecp_type, office,
                     preferred_date, time_slot,
                     email, phone, passport_last4, snils,
                     comment = r %}

            <li class="card">
                <div class="card-header">
                    <span class="card-title">#{{ id }} — {{ full_name }}</span>
                    <span class="badge badge-waiting">ЭЦП</span>
                </div>

                <div class="card-meta">
                    <span>{{ created_at }}</span>
                    {% if role %}<span> · {{ role }}</span>{% endif %}
                </div>

                <div class="card-body">
                    {% if ecp_type %}
                        <div class="card-line"><strong>Тип ЭЦП / цель:</strong> {{ ecp_type }}</div>
                    {% endif %}
                    {% if office %}
                        <div class="card-line"><strong>Место обслуживания:</strong> {{ office }}</div>
                    {% endif %}

                    <div class="card-line">
                        <strong>Дата и время визита:</strong>
                        {{ preferred_date or "—" }}{% if time_slot %} · {{ time_slot }}{% endif %}
                    </div>

                    {% if phone %}
                        <div class="card-line"><strong>Телефон:</strong> {{ phone }}</div>
                    {% endif %}
                    {% if email %}
                        <div class="card-line"><strong>E-mail:</strong> {{ email }}</div>
                    {% endif %}

                    {% if passport_last4 %}
                        <div class="card-line">
                            <strong>Последние 4 цифры паспорта:</strong> {{ passport_last4 }}
                        </div>
                    {% endif %}

                    {% if snils %}
                        <div class="card-line"><strong>СНИЛС:</strong> {{ snils }}</div>
                    {% endif %}

                    {% if comment %}
                        <div class="card-line"><strong>Комментарий:</strong> {{ comment }}</div>
                    {% endif %}
                </div>
            </li>
        {% endfor %}
    </ul>
{% endif %}
{% endblock %}
